# Implementation Plan

- [x] 1. Создать FastAPI эндпоинт для чат-помощника


  - Добавить новый эндпоинт `/chat/ask` в FastAPI сервер
  - Реализовать модели данных ChatRequest и ChatResponse
  - Создать промпт для AI с контекстом версии Minecraft
  - Добавить обработку ошибок и валидацию входных данных
  - _Requirements: 1.1, 1.2, 1.3_



- [ ] 2. Реализовать ChatAssistantApiClient для взаимодействия с AI API
  - Создать HTTP клиент для отправки запросов к `/chat/ask` эндпоинту
  - Реализовать асинхронную обработку запросов с таймаутами
  - Добавить проверку доступности API


  - Реализовать обработку ошибок сети и API
  - _Requirements: 1.1, 1.3_

- [ ] 3. Создать ChatMessageAnimator для анимированных сообщений
  - Реализовать анимацию печатания в чате


  - Добавить цветовое форматирование для разных типов ответов
  - Создать методы для разбивки длинных сообщений на части
  - Реализовать специальное форматирование для рецептов крафта
  - _Requirements: 2.1, 2.2, 2.3, 2.4_



- [ ] 4. Реализовать команду /ask в MinecraftChatAssistant
  - Создать регистрацию команды `/ask` с аргументом вопроса
  - Реализовать обработчик команды с валидацией входных данных
  - Интегрировать ChatAssistantApiClient для получения ответов
  - Добавить использование ChatMessageAnimator для отображения ответов


  - _Requirements: 1.1, 1.2, 2.1, 2.2_

- [ ] 5. Исправить JSON парсинг в системе квестов
  - Модифицировать parseAllQuestsFromJson для обработки ошибок парсинга отдельных квестов
  - Добавить валидацию JSON структуры перед парсингом


  - Реализовать сохранение корректных квестов при ошибке в одном из них
  - Улучшить промпт для AI в FastAPI для генерации валидного JSON
  - _Requirements: 3.1, 3.2, 3.3, 3.4_

- [x] 6. Исправить систему таймингов в QuestApiManager


  - Модифицировать логику проверки времени для корректного ожидания 30 минут
  - Добавить уведомление за 1 минуту до следующего запроса
  - Исправить логику повторных запросов при ошибках
  - Реализовать проверку времени последнего успешного запроса при запуске
  - _Requirements: 4.1, 4.2, 4.3, 4.4_



- [ ] 7. Реализовать систему накопления квестов в досках
  - Создать QuestAccumulation класс для управления накопленными квестами
  - Модифицировать updateBoard для добавления новых квестов к существующим
  - Реализовать логику очистки доски после 3 запросов (15 квестов)



  - Добавить автоматическое обновление интерфейса доски при добавлении квестов
  - _Requirements: 5.1, 5.2, 5.3, 5.4_

- [ ] 8. Добавить систему уведомлений для квестов
  - Реализовать уведомления о количестве полученных квестов
  - Добавить детальные сообщения об ошибках получения квестов
  - Создать обратный отсчет до следующего запроса
  - Реализовать уведомление об очистке доски квестов
  - _Requirements: 6.1, 6.2, 6.3, 6.4_

- [ ] 9. Интегрировать все компоненты и протестировать
  - Зарегистрировать команду `/ask` в системе команд мода
  - Интегрировать исправления системы квестов в QuestApiManager
  - Протестировать работу чат-помощника с различными вопросами
  - Протестировать систему квестов с накоплением через несколько циклов
  - _Requirements: 1.1, 2.1, 3.1, 4.1, 5.1, 6.1_

- [ ] 10. Создать unit тесты для критических компонентов
  - Написать тесты для JSON парсинга с различными сценариями ошибок
  - Создать тесты для валидации квестов
  - Реализовать тесты для форматирования сообщений чата
  - Добавить тесты для системы накопления квестов
  - _Requirements: 3.2, 3.4, 5.2, 5.3_