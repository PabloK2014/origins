# Requirements Document

## Introduction

Данная функция добавляет интеллектуального чат-помощника в Minecraft, который может отвечать на вопросы игроков о крафте, механиках игры и других аспектах Minecraft. Также включает исправления и улучшения существующей системы квестов для обеспечения корректной работы с API и правильного управления жизненным циклом квестов.

## Requirements

### Requirement 1

**User Story:** Как игрок, я хочу иметь возможность задавать вопросы о Minecraft через команду в чате, чтобы получать быстрые и точные ответы о крафте, механиках игры и других аспектах.

#### Acceptance Criteria

1. WHEN игрок вводит команду `/ask "вопрос"` THEN система SHALL отправить запрос к AI API с контекстом версии Minecraft
2. WHEN AI API возвращает ответ THEN система SHALL отобразить ответ в чате с красивым форматированием и анимациями
3. WHEN происходит ошибка при запросе к AI THEN система SHALL показать пользователю сообщение об ошибке
4. WHEN ответ слишком длинный THEN система SHALL разбить его на несколько сообщений с задержкой между ними

### Requirement 2

**User Story:** Как игрок, я хочу видеть красиво оформленные ответы от чат-помощника с анимациями, чтобы взаимодействие было приятным и информативным.

#### Acceptance Criteria

1. WHEN отображается ответ от AI THEN система SHALL использовать цветное форматирование текста
2. WHEN ответ содержит рецепты крафта THEN система SHALL отображать их в структурированном виде
3. WHEN ответ появляется в чате THEN система SHALL показать анимацию печатания или постепенного появления текста
4. WHEN ответ содержит несколько частей THEN система SHALL отображать их с небольшими задержками

### Requirement 3

**User Story:** Как разработчик, я хочу исправить ошибку JSON парсинга в генерации квестов, чтобы система была стабильной и не падала при некорректных данных.

#### Acceptance Criteria

1. WHEN API возвращает некорректный JSON THEN система SHALL логировать ошибку и продолжить работу
2. WHEN происходит ошибка парсинга одного квеста THEN система SHALL сохранить остальные корректные квесты
3. WHEN генерируется промпт для AI THEN система SHALL включить инструкции для генерации валидного JSON
4. WHEN получен ответ от API THEN система SHALL валидировать JSON перед парсингом

### Requirement 4

**User Story:** Как игрок, я хочу, чтобы система квестов корректно управляла таймингом запросов к API, чтобы не было лишних запросов и система работала предсказуемо.

#### Acceptance Criteria

1. WHEN получен успешный ответ с квестами THEN система SHALL ждать 30 минут перед следующим запросом
2. WHEN остается 1 минута до следующего запроса THEN система SHALL показать предупреждение в чате
3. WHEN запрос к API неуспешен THEN система SHALL показать ошибку и повторить запрос
4. WHEN система запускается THEN она SHALL проверить время последнего успешного запроса

### Requirement 5

**User Story:** Как игрок, я хочу, чтобы новые квесты добавлялись к существующим в доске объявлений, чтобы у меня было больше вариантов для выполнения.

#### Acceptance Criteria

1. WHEN получены новые квесты THEN система SHALL добавить их к существующим квестам в доске
2. WHEN в доске накапливается 15 квестов (3 запроса по 5 квестов) THEN система SHALL очистить доску перед добавлением новых
3. WHEN квесты добавляются THEN интерфейс доски SHALL автоматически обновиться
4. WHEN игрок открывает доску THEN он SHALL видеть все накопленные квесты

### Requirement 6

**User Story:** Как игрок, я хочу получать уведомления о состоянии системы квестов, чтобы понимать, когда ожидать новые квесты или когда произошла ошибка.

#### Acceptance Criteria

1. WHEN система успешно получает квесты THEN она SHALL показать сообщение о количестве полученных квестов
2. WHEN происходит ошибка получения квестов THEN система SHALL показать детальное сообщение об ошибке
3. WHEN система ожидает следующий запрос THEN она SHALL показывать обратный отсчет
4. WHEN доска квестов очищается THEN система SHALL уведомить игрока об этом